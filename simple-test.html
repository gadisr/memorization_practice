<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Cube Scrambler Test</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #1a1a1a;
            color: #ffffff;
            margin: 20px;
            line-height: 1.4;
        }
        .output {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-size: 12px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid #444;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #45a049;
        }
        .clear-btn {
            background-color: #f44336;
        }
        .clear-btn:hover {
            background-color: #da190b;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background-color: #2e7d32; }
        .error { background-color: #c62828; }
    </style>
</head>
<body>
    <h1>ğŸ§Š Simple Cube Scrambler Test</h1>
    
    <div id="status" class="status">Loading...</div>
    
    <button onclick="runTest()">ğŸ§ª Run Test</button>
    <button onclick="runExample()">ğŸ“‹ Run Example</button>
    <button onclick="testMoves()">ğŸ”„ Test Individual Moves</button>
    <button onclick="testRotations()">ğŸ”„ Test Rotation Variants</button>
    <button onclick="testSpecific()">ğŸ” Test Specific Moves</button>
    <button onclick="testEdgeTracing()">ğŸ”— Test Edge Tracing</button>
    <button onclick="testCornerTracing()">ğŸ”² Test Corner Tracing</button>
    <button onclick="clearOutput()" class="clear-btn">ğŸ—‘ï¸ Clear</button>
    
    <div id="output" class="output">Click "Run Test" to see the cube scrambler in action...</div>

    <script type="module">
        const outputDiv = document.getElementById('output');
        const statusDiv = document.getElementById('status');
        
        // Override console.log to display in the page
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            outputDiv.textContent += args.join(' ') + '\n';
            outputDiv.scrollTop = outputDiv.scrollHeight;
        };
        
        let scramblerModule = null;
        
        // Load the module
        async function loadModule() {
            try {
                statusDiv.textContent = 'Loading cube scrambler module...';
                statusDiv.className = 'status';
                
                scramblerModule = await import('./dist/services/cube-scrambler.js');
                
                statusDiv.textContent = 'âœ… Module loaded successfully!';
                statusDiv.className = 'status success';
                console.log('ğŸš€ Cube Scrambler loaded and ready!');
                
            } catch (error) {
                statusDiv.textContent = `âŒ Error loading module: ${error.message}`;
                statusDiv.className = 'status error';
                console.log('âŒ Failed to load module:', error);
            }
        }
        
        // Test basic functionality
        async function runTest() {
            try {
                console.log('\n=== ğŸ§ª BASIC FUNCTIONALITY TEST ===');
                
                if (!scramblerModule) {
                    throw new Error('Module not loaded');
                }
                
                // Test scramble generation
                const scramble = scramblerModule.generate_scramble_sequence(10);
                console.log(`ğŸ“ Generated scramble: ${scramble.join(' ')}`);
                console.log(`ğŸ”¢ Total moves: ${scramble.length}`);
                
                // Test cube scrambling
                const scrambledCube = scramblerModule.scramble_cube(scramble);
                console.log('âœ… Cube scrambled successfully!');
                
                // Test cube printing
                console.log('\nğŸ² Scrambled cube:');
                scramblerModule.print_cube(scrambledCube);
                
                console.log('\nâœ… Basic functionality test completed!');
                
            } catch (error) {
                console.log('âŒ Test failed:', error);
            }
        }
        
        // Run example
        async function runExample() {
            try {
                console.log('\n=== ğŸ“‹ EXAMPLE USAGE ===');
                
                if (!scramblerModule) {
                    throw new Error('Module not loaded');
                }
                
                scramblerModule.example_usage();
                
            } catch (error) {
                console.log('âŒ Example failed:', error);
            }
        }
        
        // Test individual moves
        async function testMoves() {
            try {
                console.log('\n=== ğŸ”„ INDIVIDUAL MOVES TEST ===');
                
                if (!scramblerModule) {
                    throw new Error('Module not loaded');
                }
                
                scramblerModule.test_individual_moves();
                
            } catch (error) {
                console.log('âŒ Individual moves test failed:', error);
            }
        }
        
        // Test rotation variants
        async function testRotations() {
            try {
                console.log('\n=== ğŸ”„ ROTATION VARIANTS TEST ===');
                
                if (!scramblerModule) {
                    throw new Error('Module not loaded');
                }
                
                scramblerModule.test_rotation_variants();
                
            } catch (error) {
                console.log('âŒ Rotation variants test failed:', error);
            }
        }
        
        // Test specific moves
        async function testSpecific() {
            try {
                console.log('\n=== ğŸ” SPECIFIC MOVES TEST ===');
                
                if (!scramblerModule) {
                    throw new Error('Module not loaded');
                }
                
                scramblerModule.test_specific_moves();
                
            } catch (error) {
                console.log('âŒ Specific moves test failed:', error);
            }
        }
        
        // Test edge tracing functionality
        async function testEdgeTracing() {
            try {
                console.log('\n=== ğŸ”— EDGE TRACING TEST ===');
                
                if (!scramblerModule) {
                    throw new Error('Scrambler module not loaded');
                }
                
                // Generate a scramble
                const scramble = scramblerModule.generate_scramble_sequence(15);
                console.log(`ğŸ“ Scramble sequence: ${scramble}`);
                console.log(`ğŸ”¢ Total moves: ${scramble.split(' ').length}`);
                
                // Apply scramble to cube
                const scrambledCube = scramblerModule.scramble_cube(scramble);
                
                // Print the actual scrambled cube faces
                console.log('\nğŸ² Scrambled cube faces:');
                scramblerModule.print_cube(scrambledCube);
                
                // Load the edge tracer module
                console.log('\nğŸ² Extracting edge pieces from scrambled cube...');
                const edgeTracerModule = await import('./dist/services/edge-tracer.js');
                const edgeTracer = new edgeTracerModule.EdgeTracer();
                
                // Use the EdgeTracer method to extract edge colors
                const scrambledCubeState = edgeTracer.extractEdgeColorsFromCube(scrambledCube);
                
                // Print cube colors before tracing
                console.log('\nğŸ“Š Cube state before tracing:');
                const allPositions = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 
                                     'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x'];
                allPositions.forEach(pos => {
                    if (scrambledCubeState[pos]) {
                        console.log(`  ${pos}: ${scrambledCubeState[pos].colors[0]}-${scrambledCubeState[pos].colors[1]}`);
                    }
                });
                
                // Use the EdgeTracer's built-in full trace method
                console.log('\nğŸ”„ Running full edge tracing algorithm...');
                const tracingString = edgeTracer.do_full_trace(scrambledCubeState);
                
                // Display final results
                console.log('\nğŸ¯ FINAL EDGE TRACING RESULTS:');
                console.log(`ğŸ“ Complete tracing string: "${tracingString}"`);
                console.log(`ğŸ“Š Total cycles found: ${tracingString.trim().split(' ').filter(s => s).length} pieces`);
                
                if (tracingString.trim() === "") {
                    console.log('âœ… No cycles needed - cube is solved!');
                } else {
                    console.log('ğŸ”„ Cycles found - cube needs solving');
                }
                
                console.log('\nâœ… Edge tracing completed successfully!');
                
            } catch (error) {
                console.log('âŒ Edge tracing test failed:', error);
            }
        }
        
        // Test corner tracing functionality
        async function testCornerTracing() {
            try {
                console.log('\n=== ğŸ”² CORNER TRACING TEST ===');
                
                if (!scramblerModule) {
                    throw new Error('Scrambler module not loaded');
                }
                
                // Generate a scramble
                const scramble = scramblerModule.generate_scramble_sequence(15);
                console.log(`ğŸ“ Scramble sequence: ${scramble}`);
                console.log(`ğŸ”¢ Total moves: ${scramble.split(' ').length}`);
                
                // Apply scramble to cube
                const scrambledCube = scramblerModule.scramble_cube(scramble);
                
                // Print the actual scrambled cube faces
                console.log('\nğŸ² Scrambled cube faces:');
                scramblerModule.print_cube(scrambledCube);
                
                // Load the corner tracer module
                console.log('\nğŸ² Extracting corner pieces from scrambled cube...');
                const cornerTracerModule = await import('./dist/services/corner-tracer.js');
                const cornerTracer = new cornerTracerModule.CornerTracer();
                
                // Use the CornerTracer method to extract corner colors
                const scrambledCubeState = cornerTracer.extractCornerColorsFromCube(scrambledCube);
                
                // Print cube colors before tracing
                console.log('\nğŸ“Š Cube state before tracing:');
                const allPositions = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'];
                allPositions.forEach(pos => {
                    if (scrambledCubeState[pos]) {
                        console.log(`  ${pos}: ${scrambledCubeState[pos].colors[0]}-${scrambledCubeState[pos].colors[1]}-${scrambledCubeState[pos].colors[2]}`);
                    }
                });
                
                // Use the CornerTracer's built-in full trace method
                console.log('\nğŸ”„ Running full corner tracing algorithm...');
                const tracingString = cornerTracer.do_full_trace(scrambledCubeState);
                
                // Display final results
                console.log('\nğŸ¯ FINAL CORNER TRACING RESULTS:');
                console.log(`ğŸ“ Complete tracing string: "${tracingString}"`);
                console.log(`ğŸ“Š Total cycles found: ${tracingString.trim().split(' ').filter(s => s).length} pieces`);
                
                if (tracingString.trim() === "") {
                    console.log('âœ… No cycles needed - cube is solved!');
                } else {
                    console.log('ğŸ”„ Cycles found - cube needs solving');
                }
                
                console.log('\nâœ… Corner tracing completed successfully!');
                
            } catch (error) {
                console.log('âŒ Corner tracing test failed:', error);
            }
        }
        
        // Clear output
        function clearOutput() {
            outputDiv.textContent = '';
        }
        
        // Make functions available globally
        window.runTest = runTest;
        window.runExample = runExample;
        window.testMoves = testMoves;
        window.testRotations = testRotations;
        window.testSpecific = testSpecific;
        window.testEdgeTracing = testEdgeTracing;
        window.testCornerTracing = testCornerTracing;
        window.clearOutput = clearOutput;
        
        // Load the module when page loads
        loadModule();
    </script>
</body>
</html>